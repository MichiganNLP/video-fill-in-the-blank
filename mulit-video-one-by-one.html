<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
  integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

<style>
  #instructions,
  li {
    color: gray;
  }

  #container {
    position: relative;
  }

  #comments{
    border-radius: 15px;
    border: 4px dashed #cee3e9;
  }

  .in-box-answer {
    border: 1.5px solid #C2C2C2;
    box-shadow: 1px 1px 4px #EBEBEB;
    border-radius: 4px;
    padding: 5px;
    margin-left: 1px;
    margin-bottom: 2px;
  }

  .in-box-answer:hover{
    border: 2px solid black;
  }


  .video-controls {
    border-radius: 15px;
    background-color: rgba(117, 122, 118, 0.822);
    /* Green */
    border: white;
    color: white;
    padding: 7px 15px;
    text-align: center;
    font-size: 16px;
  }

  .pre-question-label{
    font-size: 23px;
    padding-left:40px;
  }

  .question {
    margin: auto auto 20px auto;
    text-align: center;
  }

  .video {
    display: block;
    height: 360px;
    margin: 10px auto;
  }

  .loading-video {
    position: relative;
    top: 50%;
    text-align: center;
  }

  .video-relates {
    position: relative;
    text-align: center;
  }

  .answer-label-div {
    text-align: center;
  }

  .instance {
    border-radius: 15px;
    border: 4px dashed #cee3e9;
    margin-bottom: 10px;
  }

  .removeClick {
    background-color: #888888;
    border-radius: 50%;
    color: white;
    height: 25px;
    border: 2px solid white;
    vertical-align:middle;
    line-height: 9px;
}
.removeClick:hover {
    background-color: white;
    color: black;
    border: 2px solid grey;
}

 .out-box-answer{
   height: 24px;
   width: auto;
   font-style:italic;
   text-align: center;
   border-radius: 12px;
   background-color: 	#E0E0E0;
   border: white;
 }

 .less-2{
  text-align: center; /*让div内部文字居中*/
  font-size: 24px;
 }

 .less-2-checkbox{
  width:22px;
  height:22px;
 }

/* .removeClick:hover {background: #bbb;} */

  #error-message1,
  #error-message2,
  #error-message3,
  #error-message4,
  #error-message5 {
    margin: auto;
    width: 50%;
    display: none;
    text-align: center;
  }
</style>

<crowd-form  onsubmit="return checkvalid()">
  <div id="container" class="container">
    <h1 id="general-title">Fill in the blanks according to video content</h1>

    <details id="instructions">
      <summary>Instructions (including <b>bonus</b> information)</summary>

      <br>

      <p>We need help answering ("filling") these blanks based on video content (including the audio).</p>

      <h2>Basic Instructions</h2>

      <ul>
        <li>There are five sentences with a blank, you need to fill in <u>all</u> five blanks 
          according to the content in the video (including audio).</li>
        <li>
          To "fill in the blank", write in the text box and press Enter. Provide one or more answers.
        </li>
        <ul>
          <li>
            Each answer needs to be one or more entities (a noun phrase), which should contain <b>one or more words</b>.
          </li>
          <li>
            The answers may refer to different things, but could also (and likely will) be different ways of saying the same thing 
            (as we seek diversity in the answers).
          </li>
        </ul>
        <ul>
          <li>Provide the answers <b>in order</b>: the first answer should be the most natural to you, 
            the last answer should be the least natural to you; but all should be valid answers.</li>
        </ul>
        <li>If the video is unavailable, just fill in <u><i>"unavailable video"</i></u>.</li>
      </ul>

      <h2>How To Answer</h2>

      Each answer should be one or more <b>valid</b>, <b>natural</b>, <b>objective</b> and <b>brief</b> entities,
      and should complete the text such that the text becomes a good description of the video.

      <ul>
        <li>
          Each answer should contain one or more words.
        </li>
        <li>It should be valid, in the sense that it should be an appropriate answer for what is represented in the
          video.</li>
        <ul>
          <li>E.g., saying <i>"<font color="red">cat</font>"</i> when there's clearly no cat but a <i>dog</i> in the video, is considered <u>invalid</u>.
          </li>
        </ul>
        <li>It should be natural, in the sense that it should be something you would normally say in the situation shown
          in the video.</li>
        <ul>
          <li>E.g., <i>"<font color="red">object</font>"</i> and <i>"<font color="red">entity</font>"</i> <u>aren't</u> something you'd naturally say.</li>
        </ul>
        <li>They should be <u>in order</u>. The first answer should be the one that naturally comes to your mind first, 
          and the following ones should feel less and less natural to you.
        </li>
        <li>Respond matter-of-factly (as objectively as possible). Stick to what you can see or hear from the video.</li>
        <ul>
          <li>E.g., <i>“<font color="red">beautiful</font>”</i> is likely <u>not</u> a good word to use within an answer.</li>
        </ul>
        <li>Don't use descriptors unless necessary.</li>
        <ul>
          <li><i>"<font color="red">yellow ball</font>"</i> -> <i>"<font color="blue">ball</font>"</i></li>
          <li><i>"<font color="red">cute dog</font>"</i> -> <i>"<font color="blue">dog</font>"</i></li>
        </ul>
        <li>
          When you enter numbers, please enter digits instead of text
          <ul>
            <li><i>"<font color="red">Seventeen</font>"</i> -> <i>"<font color="blue">17</font>"</i></li>
          </ul>
        </li>
        <li>Try not to use the title or the description from the video to fill in the blank.</li>
        <li>Use your best judgment.</li>
      </ul>

      <h2>HIT Acceptance</h2>

      Your HITs will be accepted based on how <b>accurate</b> and <b>comprehensive</b> your answers are.

      <ul>
        <li>Generally speaking, the more answers you provide, the better.</li>
        <li>But remember, every answer has to be <u>valid</u>, <u>natural</u>, <u>objective</u>, and <u>brief</u> for the given context.</li>
        <li>
          The top workers will be awarded a <b>bonus</b>.
        </li>
      </ul>

      <div class="instance" id="example" style="color: black">
        <br>
        <h2 style="text-align: center">Example</h2>
        <div class="video" id="video0">
          <p class="loading-video">Loading video...</p>
        </div>
        <div class="video-relates">
          <label id="video-instruction-example" style="font-size:18px;">
            Please watch this <i>10-second</i> video while you listen to its <b><u>audio</u></b> (you may need to adjust
            your <b>device volume</b>).
            <br>When the video ends, <b>do not</b> click on any other video. Click the <u>buttons below</u> to control the
            video.
          </label>
          <br>
          <button id="minus-seconds0" type="button" class="video-controls">- 5s</button>
          <button id="speed-down0" type="button" class="video-controls">Speed<big>&#8595</big></button>
          <button id="restart-video0" type="button" class="video-controls"><big>&#8634</big></button>
          <button id="speed-up0" type="button" class="video-controls">Speed<big>&#8593</big></button>
          <button id="add-seconds0" type="button" class="video-controls">+ 5s</button>
        </div>
        <hr>
  
        <label class="pre-question-label" id="pre-question-label-example"><i><b>Fill in the blank</b> (Type an entity and hit Enter):</i></label>
        <h2 class="question" id="question-example">The person drinks <input type="text" class="in-box-answer" name="in-answer-example" placeholder="Type an entity and hit Enter" \
          style= "width:250px; height:40px;font-size:17px"  disabled="disabled"> in a bar.</h2>
        <div class="inputed-answers" id="inputed-answers-example">
          <input type="text" class="out-box-answer" value="beer" name="answer-example-1" style="width: 63px;" disabled="disabled"><button class="removeClick" disabled="disabled">x</button>
          <input type="text" class="out-box-answer" value="a bottle of beer" name="answer-example-2" style="width: 189px;" disabled="disabled"><button class="removeClick" disabled="disabled">x</button>
          <input type="text" class="out-box-answer" value="the beverage" name="answer-example-3" style="width: 147px;" disabled="disabled"><button class="removeClick" disabled="disabled">x</button>
          <input type="text" class="out-box-answer" value="liquor" name="answer-example-4" style="width: 84px;" disabled="disabled"><button class="removeClick" disabled="disabled">x</button>
        </div>

        <div class="answer-label-div">
          <label style="font-size:18px;" for="answers" class="answer-label" id="answer-label1">
            Each provided answer needs to be <big><i><u><b>one or more entities</b></u></i></big>, which should contain one or more words;
            <br>Please review the <a href="#instructions">Instructions</a> (includes information about the <b>bonus</b>);
            <br>Fill in <b>valid</b>, <b>natural</b>, <b>objective</b> and <b>brief</b>;
            <br>You need to fill in at least 1 answer. If you can not fill in 2 or more answers, click the <b>checkbox</b>;
            <br>The more you fill in, with the higher probability you can get the <b>bonus</b>;
            <br>Try not to use the title or the description from the video to fill in the blank;
            <br>Fill in the boxes <b>in order</b> from the most natural to the least natural answer.
        </div>
        <br>
      </div>

      <button type="button" id ="close-instructions" style="background-color: white; border: none; text-align: center; color:grey; font-size: 17px;" onclick="closeDetails()">
         &#x25B2 Close Instructions</button>

    </details>

    <hr>

    <div class="instance" id="instance1">
      <br>
      <h2 style="text-align: center">Blank 1</h2>
      <div class="video" id="video1">
        <p class="loading-video">Loading video...</p>
      </div>
      <div class="video-relates">
        <label id="video-instruction1" style="font-size:18px;">
          Please watch this <i>-- second</i> video while you listen to its <b><u>audio</u></b> (you may need to adjust
          your <b>device volume</b>).
          <br>When the video ends, <b>do not</b> click on any other video. Click the <u>buttons below</u> to control the
          video.
        </label>
        <br>
        <button id="minus-seconds1" type="button" class="video-controls">- 5s</button>
        <button id="speed-down1" type="button" class="video-controls">Speed<big>&#8595</big></button>
        <button id="restart-video1" type="button" class="video-controls"><big>&#8634</big></button>
        <button id="speed-up1" type="button" class="video-controls">Speed<big>&#8593</big></button>
        <button id="add-seconds1" type="button" class="video-controls">+ 5s</button>
      </div>
      <hr>

      <label class="pre-question-label" id="pre-question-label1"><i><b>Fill in the blank</b> (Type an entity and hit Enter):</i></label>
        <h2 class="question" id="question1">Loading question...</h2>
        <div class="inputed-answers" id="inputed-answers1"></div>
        <div class="less-2" id="less-2-1">
          <p>
            <input type="checkbox" class="less-2-checkbox" id="less-2-checkbox1" name="less-2-checkbox1" value="Can not fill in 2 or more answers.">
            Can not fill in 2 or more answers.
          </p>
        </div>

      <div class="alert alert-info" id="error-message1"></div>

      <div class="answer-label-div">
        <label style="font-size:18px;" for="answers" class="answer-label" id="answer-label1">
          Each provided answer needs to be <big><i><u><b>one or more entities</b></u></i></big>, which should contain one or more words;
          <br>Please review the <a href="#instructions">Instructions</a> (includes information about the <b>bonus</b>);
          <br>Fill in <b>valid</b>, <b>natural</b>, <b>objective</b> and <b>brief</b> answers;
          <br>You need to fill in at least 1 answer. If you can not fill in 2 or more answers, click the <b>checkbox</b>;
          <br>The more you fill in, with the higher probability you can get the <b>bonus</b>;
          <br>Try not to use the title or the description from the video to fill in the blank;
          <br>Fill in the boxes <b>in order</b> from the most natural to the least natural answer.
      </div>

    </div>
    <div class="instance" id="instance2">
      <br>
      <h2 style="text-align: center">Blank 2</h2>
      <div class="video" id="video2">
        <p class="loading-video">Loading video...</p>
      </div>
      <div class="video-relates">
        <label id="video-instruction2" style="font-size:18px;">
          Please watch this <i>-- second</i> video while you listen to its <b><u>audio</u></b> (you may need to adjust
          your <b>device volume</b>).
          <br>When the video ends, <b>do not</b> click on any other video. Click the <u>buttons below</u> to control the
          video.
        </label>
        <br>
        <button id="minus-seconds2" type="button" class="video-controls">- 5s</button>
        <button id="speed-down2" type="button" class="video-controls">Speed<big>&#8595</big></button>
        <button id="restart-video2" type="button" class="video-controls"><big>&#8634</big></button>
        <button id="speed-up2" type="button" class="video-controls">Speed<big>&#8593</big></button>
        <button id="add-seconds2" type="button" class="video-controls">+ 5s</button>
      </div>
      <hr>

      <label class="pre-question-label" id="pre-question-label2"><i><b>Fill in the blank</b> (Type an entity and hit Enter):</i></label>
        <h2 class="question" id="question2">Loading question...</h2>
        <div class="inputed-answers" id="inputed-answers2"></div>
        <div class="less-2" id="less-2-2">
          <p>
            <input type="checkbox" class="less-2-checkbox" id="less-2-checkbox2" name="less-2-checkbox2" value="Can not fill in 2 or more answers.">
            Can not fill in 2 or more answers.
          </p>
        </div>

      <div class="alert alert-info" id="error-message2"></div>

      <div class="answer-label-div">
        <label style="font-size:18px;" for="answers" class="answer-label" id="answer-label2">
          Each provided answer needs to be <big><i><u><b>one or more entities</b></u></i></big>, which should contain one or more words;
          <br>Please review the <a href="#instructions">Instructions</a> (includes information about the <b>bonus</b>);
          <br>Fill in <b>valid</b>, <b>natural</b>, <b>objective</b> and <b>brief</b> answers;
          <br>You need to fill in at least 1 answer. If you can not fill in 2 or more answers, click the <b>checkbox</b>;
          <br>The more you fill in, with the higher probability you can get the <b>bonus</b>;
          <br>Try not to use the title or the description from the video to fill in the blank;
          <br>Fill in the boxes <b>in order</b> from the most natural to the least natural answer.
      </div>

    </div>
    <div class="instance" id="instance3">
      <br>
      <h2 style="text-align: center">Blank 3</h2>
      <div class="video" id="video3">
        <p class="loading-video">Loading video...</p>
      </div>
      <div class="video-relates">
        <label id="video-instruction3" style="font-size:18px;">
          Please watch this <i>-- second</i> video while you listen to its <b><u>audio</u></b> (you may need to adjust
          your <b>device volume</b>).
          <br>When the video ends, <b>do not</b> click on any other video. Click the <u>buttons below</u> to control the
          video.
        </label>
        <br>
        <button id="minus-seconds3" type="button" class="video-controls">- 5s</button>
        <button id="speed-down3" type="button" class="video-controls">Speed<big>&#8595</big></button>
        <button id="restart-video3" type="button" class="video-controls"><big>&#8634</big></button>
        <button id="speed-up3" type="button" class="video-controls">Speed<big>&#8593</big></button>
        <button id="add-seconds3" type="button" class="video-controls">+ 5s</button>
      </div>
      <hr>

      <label class="pre-question-label" id="pre-question-label3"><i><b>Fill in the blank</b> (Type an entity and hit Enter):</i></label>
        <h2 class="question" id="question3">Loading question...</h2>
        <div class="inputed-answers" id="inputed-answers3"></div>
        <div class="less-2" id="less-2-3">
          <p>
            <input type="checkbox" class="less-2-checkbox" id="less-2-checkbox3" name="less-2-checkbox3" value="Can not fill in 2 or more answers.">
            Can not fill in 2 or more answers.
          </p>
        </div>

      <div class="alert alert-info" id="error-message3"></div>

      <div class="answer-label-div">
        <label style="font-size:18px;" for="answers" class="answer-label" id="answer-label3">
          Each provided answer needs to be <big><i><u><b>one or more entities</b></u></i></big>, which should contain one or more words;
          <br>Please review the <a href="#instructions">Instructions</a> (includes information about the <b>bonus</b>);
          <br>Fill in <b>valid</b>, <b>natural</b>, <b>objective</b> and <b>brief</b> answers;
          <br>You need to fill in at least 1 answer. If you can not fill in 2 or more answers, click the <b>checkbox</b>;
          <br>The more you fill in, with the higher probability you can get the <b>bonus</b>;
          <br>Try not to use the title or the description from the video to fill in the blank;
          <br>Fill in the boxes <b>in order</b> from the most natural to the least natural answer.
      </div>

    </div>
    <div class="instance" id="instance4">
      <br>
      <h2 style="text-align: center">Blank 4</h2>
      <div class="video" id="video4">
        <p class="loading-video">Loading video...</p>
      </div>
      <div class="video-relates">
        <label id="video-instruction4" style="font-size:18px;">
          Please watch this <i>-- second</i> video while you listen to its <b><u>audio</u></b> (you may need to adjust
          your <b>device volume</b>).
          <br>When the video ends, <b>do not</b> click on any other video. Click the <u>buttons below</u> to control the
          video.
        </label>
        <br>
        <button id="minus-seconds4" type="button" class="video-controls">- 5s</button>
        <button id="speed-down4" type="button" class="video-controls">Speed<big>&#8595</big></button>
        <button id="restart-video4" type="button" class="video-controls"><big>&#8634</big></button>
        <button id="speed-up4" type="button" class="video-controls">Speed<big>&#8593</big></button>
        <button id="add-seconds4" type="button" class="video-controls">+ 5s</button>
      </div>
      <hr>

      <label class="pre-question-label" id="pre-question-label4"><i><b>Fill in the blank</b> (Type an entity and hit Enter):</i></label>
        <h2 class="question" id="question4">Loading question...</h2>
      <div class="inputed-answers" id="inputed-answers4"></div>
      <div class="less-2" id="less-2-4">
        <p>
          <input type="checkbox" class="less-2-checkbox" id="less-2-checkbox4" name="less-2-checkbox4" value="Can not fill in 2 or more answers.">
          Can not fill in 2 or more answers.
        </p>
      </div>
      
      <div class="alert alert-info" id="error-message4"></div>

      <div class="answer-label-div">
        <label style="font-size:18px;" for="answers" class="answer-label" id="answer-label4">
          Each provided answer needs to be <big><i><u><b>one or more entities</b></u></i></big>, which should contain one or more words;
          <br>Please review the <a href="#instructions">Instructions</a> (includes information about the <b>bonus</b>);
          <br>Fill in <b>valid</b>, <b>natural</b>, <b>objective</b> and <b>brief</b> answers;
          <br>You need to fill in at least 1 answer. If you can not fill in 2 or more answers, click the <b>checkbox</b>;
          <br>The more you fill in, with the higher probability you can get the <b>bonus</b>;
          <br>Try not to use the title or the description from the video to fill in the blank;
          <br>Fill in the boxes <b>in order</b> from the most natural to the least natural answer.
      </div>

    </div>
    <div class="instance" id="instance5">
      <br>
      <h2 style="text-align: center">Blank 5</h2>
      <div class="video" id="video5">
        <p class="loading-video">Loading video...</p>
      </div>
      <div class="video-relates">
        <label id="video-instruction5" style="font-size:18px;">
          Please watch this <i>-- second</i> video while you listen to its <b><u>audio</u></b> (you may need to adjust
          your <b>device volume</b>).
          <br>When the video ends, <b>do not</b> click on any other video. Click the <u>buttons below</u> to control the
          video.
        </label>
        <br>
        <button id="minus-seconds5" type="button" class="video-controls">- 5s</button>
        <button id="speed-down5" type="button" class="video-controls">Speed<big>&#8595</big></button>
        <button id="restart-video5" type="button" class="video-controls"><big>&#8634</big></button>
        <button id="speed-up5" type="button" class="video-controls">Speed<big>&#8593</big></button>
        <button id="add-seconds5" type="button" class="video-controls">+ 5s</button>
      </div>
      <hr>

      <label class="pre-question-label" id="pre-question-label5"><i><b>Fill in the blank</b> (Type an entity and hit Enter):</i></label>
        <h2 class="question" id="question5">Loading question...</h2>
      <div class="inputed-answers" id="inputed-answers5"></div>
      <div class="less-2" id="less-2-5">
        <p>
          <input type="checkbox" class="less-2-checkbox" id="less-2-checkbox5" name="less-2-checkbox5" value="Can not fill in 2 or more answers.">
          Can not fill in 2 or more answers.
        </p>
      </div>

      <div class="alert alert-info" id="error-message5"></div>

      <div class="answer-label-div">
        <label style="font-size:18px;" for="answers" class="answer-label" id="answer-label5">
          Each provided answer needs to be <big><i><u><b>one or more entities</b></u></i></big>, which should contain one or more words;
          <br>Please review the <a href="#instructions">Instructions</a> (includes information about the <b>bonus</b>);
          <br>Fill in <b>valid</b>, <b>natural</b>, <b>objective</b> and <b>brief</b> answers;
          <br>You need to fill in at least 1 answer. If you can not fill in 2 or more answers, click the <b>checkbox</b>;
          <br>The more you fill in, with the higher probability you can get the <b>bonus</b>;
          <br>Try not to use the title or the description from the video to fill in the blank;
          <br>Fill in the boxes <b>in order</b> from the most natural to the least natural answer.
      </div>

    </div>
    <div>
      <textarea class="form-control" id="comments" name="comments" rows="10"
                          placeholder="Please, write any comment/error/suggestion you have."></textarea>
    </div>

  </div>
  <crowd-button id="submit-button" form-action="submit" variant="primary">Submit</crowd-button>
</crowd-form>

<script src="https://assets.crowd.aws/crowd-html-elements.js"></script>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
  integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
  integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
  integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>


<script type="text/javascript">
  // Define variables
  let videoIds = ['k7aPk5JcT-Q','${video1_id}', '${video2_id}', '${video3_id}', '${video4_id}', '${video5_id}'];
  // let questions = ['${question1}','${question2}','${question3}','${question4}','${question5}'];
  let questions = ['A man is watching [MASK] at home.','A dog run into [MASK].','[MASK] is cooking.','Many [MASK] in the store.','[MASK] is teaching students.'];
  let startTimes = ['0', Math.floor(parseFloat('${video1_start_time}')), Math.floor(parseFloat('${video2_start_time}')),
    Math.floor(parseFloat('${video3_start_time}')), Math.floor(parseFloat('${video4_start_time}')),
    Math.floor(parseFloat('${video5_start_time}'))];
  let endTimes = ['10', Math.floor(parseFloat('${video1_end_time}')), Math.floor(parseFloat('${video2_end_time}')),
    Math.floor(parseFloat('${video3_end_time}')), Math.floor(parseFloat('${video4_end_time}')),
    Math.floor(parseFloat('${video5_end_time}'))];
  // var poswarns = ["an adjective", "an adjective", "an adjective", "an adjective", "an adjective"];
  var poswarns = ["entity", "entity", "entity", "entity", "entity"];
  // Process variable
  for (ind = 0; ind != 5; ind++) {
    // videoIds[ind] = videoIds[ind].substring(2);
    questions[ind] = questions[ind].replace("[MASK]", "<input type=\"text\" class=\"in-box-answer\" name=\"in-answer-box"+(ind+1).toString()+"\" placeholder=\"Type an entity and hit Enter\" \
    style=\"width:250px; height:40px;font-size:17px\">");
    // questions[ind] = questions[ind].replace("[MASK]", "<a href=\"#error-message"+(ind+1).toString()+"\" style=\"color:#B2BABB;\"><u><i>&ltadjective&gt</i></u></a>");
    // if (postags[ind] == "NN") {
    //   poswarns[ind] = "a noun";
    //   questions[ind] = questions[ind].replace("<u><i>&ltadjective&gt</i></u>", "<a href=\"#error-message"+(ind+1).toString()+"\" style=\"color:#B2BABB;\"><u><i>&ltnoun&gt</i></u></a>");
    // }
  }

  var tag = document.createElement('script');
  tag.src = "https://www.youtube.com/iframe_api";
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

  // noinspection JSUnusedGlobalSymbols
  let players = [0, 0, 0, 0, 0, 0];
  function onYouTubeIframeAPIReady() {
    for (ind = 0; ind != 6; ind++) {
      players[ind] = new YT.Player('video' + ind.toString(), {
        videoId: videoIds[ind],
        playerVars: {
          enablejsapi: 1,
          loop: 1,
          autoplay: 0,
          controls: 0,            // hide the controls
          disablekb: 1,           // not respond to keyboard controls
          modestbranding: 1,
          fs: 0,                  // full screen button
          cc_load_policy: 0,      // Hide closed captions
          iv_load_policy: 3,      // Hide the Video Annotations
          start: startTimes[ind],
          end: endTimes[ind],
        }
      });
    }
  }

  // video bottons
  for (let ind = 0; ind != 6; ind++) {
    $("#restart-video"+ind.toString()).click(function () {
      players[ind].seekTo(startTimes[ind], true);
      players[ind].playVideo();
    });

    $("#add-seconds"+ind.toString()).click(function () {
      let ct = players[ind].getCurrentTime();
      if (ct + 5 >= endTimes[ind]) players[ind].seekTo(Math.max(endTimes[ind] - 1, startTimes[ind]), true);
      else players[ind].seekTo(ct + 5, true);
    });

    $("#minus-seconds"+ind.toString()).click(function () {
      let ct = players[ind].getCurrentTime();
      if (ct - 5 <= startTimes[ind]) players[ind].seekTo(startTimes[ind], true);
      else players[ind].seekTo(ct - 5, true);
    });

    let speeds = [0.25, 0.5, 1, 1.5, 2];
    let speedIndexs =[2,2,2,2,2,2];

    $("#speed-up"+ind.toString()).click(function () {
      if (speedIndexs[ind] < 4) {
        speedIndexs[ind] += 1;
        players[ind].setPlaybackRate(speeds[speedIndexs[ind]]);
      }
    });

    $("#speed-down"+ind.toString()).click(function () {
      if (speedIndexs[ind] > 0) {
        speedIndexs[ind] -= 1;
        players[ind].setPlaybackRate(speeds[speedIndexs[ind]]);
      }
    });
  }

  function closeDetails() {
    document.getElementById("instructions").removeAttribute("open");
    window.location = "#general-title";
    }

  function checkvalid() { // submit button
    let valid_account = 0;
    for (let ind = 1; ind != 6; ind++) {
      let answered_account = 0;
      const $less3box = document.getElementById("less-2-checkbox"+ind.toString());
      $('#instance'+ind.toString()+' input[type="text"].out-box-answer').each(function () {
        if ($(this).val() != "") {
          answered_account += 1;
        }
      });
      if(answered_account >= 2 || (answered_account == 1 && $less3box.checked)){
        valid_account += 1;
      }
    };
    if(valid_account < 5){
      alert("Fill in at least 1 answers for each question.\n"+
      "If you can not fill in 2 or more answers for one question, please click the checkbox for that question.");
      return false;
    }
    return true;
  };

  function onDomContentLoaded() {
    // functions list
    ToNextBoxs = [];
    AtLeastOneFilleds = [];

    for(let ind=1;ind!=6;ind++){
      const $video_instruction = document.getElementById("video-instruction"+ind.toString()).innerHTML;
      // const $answer_label = document.getElementById("answer-label"+ind.toString()).innerHTML;
      // const $prequestion = document.getElementById("pre-question-label"+ind.toString()).innerHTML;
      const $question = document.getElementById('question'+ind.toString());
      const $answer1 = document.getElementById('answer'+ind.toString()+'-1');
      const $errormessage = document.getElementById('error-message'+ind.toString());
      const $less3div = document.getElementById("less-2-"+ind.toString());
      // show video length
      document.getElementById("video-instruction"+ind.toString()).innerHTML = $video_instruction.replace("-- ", (endTimes[ind-1] - startTimes[ind-1]).toString()+"-");
      // show POS-tag
      // document.getElementById("answer-label"+ind.toString()).innerHTML = $answer_label.replace("--", poswarns[ind-1]);
      // document.getElementById("pre-question-label"+ind.toString()).innerHTML = $prequestion.replace("--", poswarns[ind-1]);

      $question.innerHTML = questions[ind-1];
      $($errormessage).text("Please fill in with at least one answer").fadeIn();
      $($less3div).fadeOut("fast")
      document.getElementById('instance'+ind.toString()).querySelectorAll('input').forEach(item => {
        item.addEventListener('keydown', event => {
          ToNextBoxs[ind-1](item);
        });
        item.addEventListener('keyup', event => {
          AtLeastOneFilleds[ind-1]();
        });
      })


      // at least two answers should be provided
      AtLeastOneFilled = function() {
        let answered_account = 0;
        $('#instance'+ind.toString()+' input[type="text"].out-box-answer').each(function () {
          if ($(this).val() != "") {
            answered_account += 1;
          }
        });
        if (answered_account < 1) {
          $($errormessage).text("Please fill in with at least one answer").fadeIn();
          $($less3div).fadeOut("fast");
        }
        else if(answered_account == 1){
          $($errormessage).fadeOut("fast");
          $($less3div).fadeIn();
        }
        else{  // answered_account >= 2
          $($less3div).fadeOut("fast");
          $($errormessage).fadeOut("fast");
        }
      };

      // create new inputted answer
      if(ind == 5){
        ToNextBox = function(node){
          if (event.ctrlKey && event.keyCode == 13) {     // Ctrl + Enter, submit
            event.preventDefault();
            // document.getElementById("submit-button").click();
          }
          else if (event.keyCode == 13) {                 // Enter, add new inputted box
            event.preventDefault();
            inputed_account = node.parentNode.nextElementSibling.children.length/2;
            var new_input = document.createElement("input");
            var new_click = document.createElement("button")
            var new_space = document.createTextNode(",\u00A0");
            new_click.innerHTML = "x"
            new_click.className = "removeClick";
            new_click.addEventListener("click",
              function(){
                new_click.parentNode.removeChild(new_click.nextSibling);
                new_click.parentNode.removeChild(new_click.previousElementSibling);
                new_click.parentNode.removeChild(new_click);
                AtLeastOneFilleds[ind-1]();
              })
            new_input.type = "text";
            new_input.className = "out-box-answer";
            new_input.value = node.value;
            $(new_input).css("width",(parseInt($(new_input).val().length)+2)*10.5);
            $(new_input).bind('input propertychange', function() {  // change input box length
                    var $this = $(this);
                    var text_length = $this.val().length;
                    var current_width = (parseInt(text_length)+2) *10.5;
                    $this.css("width",current_width+"px");
                });
            new_input.addEventListener('keyup', event => {
              AtLeastOneFilleds[ind-1]();
            });
            new_input.addEventListener('keydown', event => {
              if(event.keyCode == 13) {
                event.preventDefault();
              }
            });
            node.value = ""
            new_input.name = "answer"+(ind).toString()+"-"+(inputed_account+1).toString();
            node.parentNode.nextElementSibling.appendChild(new_input);
            node.parentNode.nextElementSibling.appendChild(new_click);
            node.parentNode.nextElementSibling.appendChild(new_space);
          }
        };
      }
      else{
        ToNextBox = function(node){
          if (event.keyCode == 13) {                      // Crtrl, add box
            event.preventDefault();
            inputed_account = node.parentNode.nextElementSibling.children.length/2;
            var new_input = document.createElement("input");
            var new_click = document.createElement("button")
            var new_space = document.createTextNode(",\u00A0");
            new_click.innerHTML = "x"
            new_click.className = "removeClick";
            new_click.addEventListener("click",
              function(){
                new_click.parentNode.removeChild(new_click.nextSibling);
                new_click.parentNode.removeChild(new_click.previousElementSibling);
                new_click.parentNode.removeChild(new_click);
                AtLeastOneFilleds[ind-1]();
              })
            new_input.type = "text";
            new_input.className = "out-box-answer";
            new_input.value = node.value;
            $(new_input).css("width",(parseInt($(new_input).val().length)+2)*10.5);
            $(new_input).bind('input propertychange', function() {  // change input box length
                    var $this = $(this);
                    var text_length = $this.val().length;
                    var current_width = (parseInt(text_length)+2) *10.5;
                    $this.css("width",current_width+"px");
                });
            new_input.addEventListener('keyup', event => {
              AtLeastOneFilleds[ind-1]();
            });
            new_input.addEventListener('keydown', event => {
              if(event.keyCode == 13) {
                event.preventDefault();
              }
            });
            node.value = ""
            new_input.name = "answer"+(ind).toString()+"-"+(inputed_account+1).toString();
            node.parentNode.nextElementSibling.appendChild(new_input);
            node.parentNode.nextElementSibling.appendChild(new_click);
            node.parentNode.nextElementSibling.appendChild(new_space);
          }
        };
      }

      AtLeastOneFilleds.push(AtLeastOneFilled);
      ToNextBoxs.push(ToNextBox);
    } 
  };

  function main() {
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', onDomContentLoaded);
    } else {
      onDomContentLoaded();
    }
  }

  main();
</script>
